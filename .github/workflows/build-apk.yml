- name: "Patch MainActivity to keep tabs alive (offscreen limit)"
        run: |
          set -e
          FILE="extracted/GithubMealTester/app/src/main/java/com/example/githubmealtester/MainActivity.java"

          if [ ! -f "${FILE}" ]; then
            echo "ERROR: MainActivity.java not found at: ${FILE}"
            exit 1
          fi

          # If it's already present, do nothing
          if grep -q "setOffscreenPageLimit" "${FILE}"; then
            echo "OffscreenPageLimit already set. No changes needed."
            exit 0
          fi

          # Insert immediately after the viewPager.setAdapter(...) line
          # This is the safest anchor in your existing code structure.
          sed -i 's/\(viewPager\.setAdapter([^;]*;\)/\1\n        viewPager.setOffscreenPageLimit(4);/' "${FILE}"

          echo "Patched MainActivity.java:"
          grep -n "setOffscreenPageLimit" "${FILE}" || true
```0
